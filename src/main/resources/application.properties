# ================================================================================================
# SEP490 CLASSROOM MANAGEMENT SYSTEM - WEBRTC & FIREBASE CONFIGURATION
# ================================================================================================

# Character encoding
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.force=true

# ================================================================================================
# WEBRTC AND LIVESTREAM CONFIGURATION
# ================================================================================================

# WebRTC Configuration
webrtc.stun.servers=stun:stun.l.google.com:19302,stun:stun1.l.google.com:19302,stun:stun2.l.google.com:19302
webrtc.turn.servers=
webrtc.ice.candidate.pool.size=10
webrtc.signaling.url=ws://localhost:8088/signaling

# LiveStream Configuration
livestream.rtmp.server.url=rtmp://localhost:1935/live
livestream.max.viewers.default=100
livestream.recording.enabled.default=false
livestream.chat.enabled.default=true

# Video Conference Configuration
videoconference.max.participants.default=50
videoconference.screen.sharing.enabled=true
videoconference.recording.enabled=true
videoconference.session.timeout.minutes=240

# ================================================================================================
# FIREBASE CONFIGURATION FOR CLASSROOM MANAGEMENT
# ================================================================================================

# Firebase Database Configuration
firebase.database.url=https://mve-1-default-rtdb.asia-southeast1.firebasedatabase.app/
firebase.config.path=mve-1-firebase-adminsdk.json

# Firebase Features
firebase.classroom.sync.enabled=true
firebase.realtime.updates.enabled=true
firebase.offline.support.enabled=true

# Server Configuration
server.port=8088
server.servlet.context-path=/
server.shutdown=graceful
spring.lifecycle.timeout-per-shutdown-phase=30s
server.servlet.context-path=/
server.shutdown=graceful
spring.lifecycle.timeout-per-shutdown-phase=30s

# Spring Boot Configuration
spring.main.allow-bean-definition-overriding=true
spring.profiles.active=local

# Enable email service
email.service.enabled=true

# Local File Storage Configuration
file.upload.dir=uploads

# SQL Server Database Configuration with Enhanced UTF-8 Support
spring.datasource.url=jdbc:sqlserver://localhost:1433;databaseName=classroom_management;encrypt=false;trustServerCertificate=true;sendStringParametersAsUnicode=true;characterEncoding=UTF-8;useUnicode=true;collation=Vietnamese_CI_AS;loginTimeout=30;charset=UTF-8
spring.datasource.username=sa
spring.datasource.password=12345678
spring.datasource.driver-class-name=com.microsoft.sqlserver.jdbc.SQLServerDriver

# Alternative H2 Database Configuration (for development/testing when SQL Server is not available)
# Uncomment these lines and comment out SQL Server config above if needed
# spring.datasource.url=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
# spring.datasource.username=sa
# spring.datasource.password=
# spring.datasource.driver-class-name=org.h2.Driver
# spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.H2Dialect
# spring.h2.console.enabled=true

# HikariCP Configuration
# spring.datasource.hikari.connection-timeout=60000
# spring.datasource.hikari.maximum-pool-size=5
# spring.datasource.hikari.minimum-idle=2
# spring.datasource.hikari.auto-commit=false
# spring.datasource.hikari.connection-test-query=SELECT 1

# JPA & Hibernate Configuration
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.SQLServerDialect
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
spring.jpa.properties.hibernate.globally_quoted_identifiers=false
spring.jpa.properties.hibernate.globally_quoted_identifiers_skip_column_definitions=true
spring.jpa.properties.hibernate.connection.useUnicode=true
spring.jpa.properties.hibernate.connection.CharSet=UTF-8
spring.jpa.properties.hibernate.connection.characterEncoding=UTF-8

# Database connection validation
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-test-query=SELECT 1
spring.datasource.hikari.test-while-idle=true
spring.datasource.hikari.validation-timeout=5000

# Database connection validation
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-test-query=SELECT 1
spring.datasource.hikari.test-while-idle=true
spring.datasource.hikari.validation-timeout=5000

# JSON Serialization Configuration
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.default-property-inclusion=non_null

# Transaction Management
spring.transaction.default-timeout=30
spring.transaction.rollback-on-commit-failure=true

# Flyway Configuration (Disabled)
spring.flyway.enabled=false

# Application name
spring.application.name=classroom-backend

# Security & JWT Configuration
jwt.secret=MVS490ClassroomApplicationSecretKey2025WithStrongerEntropy@#$%98765
jwt.expiration.ms=86400000

# Email Service Configuration
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=nguyenxuanphilong@gmail.com
spring.mail.password=udnr fpri qgji oqbf
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.timeout=10000
spring.mail.from.email=nguyenxuanphilong@gmail.com
spring.mail.properties.mail.debug=true

# Thymeleaf Configuration
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
spring.thymeleaf.mode=HTML
spring.thymeleaf.encoding=UTF-8
spring.thymeleaf.cache=false

# Firebase Storage Configuration (enabled for testing)
firebase.enabled=false
firebase.storage.bucket-name=mve-1-ad9e3.appspot.com
firebase.bucket-name=mve-1-ad9e3.appspot.com

# File Upload Configuration
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=50MB
spring.servlet.multipart.max-request-size=10MB

# Disable Flyway to let Hibernate ddl-auto handle the schema
spring.flyway.enabled=false

# Liquibase (another migration tool, disabled for safety)
spring.liquibase.enabled=false
spring.servlet.multipart.max-request-size=10MB

# Disable Flyway to let Hibernate ddl-auto handle the schema
spring.flyway.enabled=false

# Liquibase (another migration tool, disabled for safety)
spring.liquibase.enabled=false

# Encoding Configuration
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.force=true
spring.mandatory-file-encoding=UTF-8
spring.mvc.pathmatch.matching-strategy=ant_path_matcher
spring.mustache.charset=UTF-8

# Jackson Configuration with UTF-8 Support
spring.jackson.serialization.WRITE_DATES_AS_TIMESTAMPS=false
spring.jackson.date-format=yyyy-MM-dd HH:mm:ss
spring.jackson.time-zone=Asia/Ho_Chi_Minh
spring.jackson.default-property-inclusion=non_null

# HTTP Message Converters UTF-8 Configuration
spring.http.encoding.charset=UTF-8
spring.http.encoding.enabled=true
spring.http.encoding.force=true
spring.http.encoding.force-request=true
spring.http.encoding.force-response=true

# Content Type Configuration
spring.mvc.contentnegotiation.favor-parameter=false
spring.mvc.contentnegotiation.favor-path-extension=false
spring.mvc.contentnegotiation.media-types.json=application/json;charset=UTF-8

# Logging Configuration
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.level.org.springframework.web=INFO
logging.level.org.springframework.boot.web.embedded.tomcat=INFO
logging.level.com.classroomapp=DEBUG
logging.level.com.classroomapp.classroombackend.filter.JwtAuthenticationFilter=DEBUG
logging.level.com.classroomapp.classroombackend.security=DEBUG
logging.level.org.springframework.security=DEBUG

# Console and File Encoding
logging.charset.console=UTF-8
logging.charset.file=UTF-8
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} -- %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} -- %msg%n

# Logback Configuration
# Use emoji-safe configuration for better Windows compatibility
# logging.config=classpath:logback-emoji-safe.xml

# Jitsi Configuration
jitsi.domain=meet.jit.si
jitsi.app-id=classroom_app
